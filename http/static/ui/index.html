<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Home - LightStar</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="/static/asset/bootstrap/4.0.0/css/bootstrap.css">
    <!-- LightStar theme -->
    <link rel="stylesheet" href="/static/css/boot.css">
    <link rel="stylesheet" href="/static/css/main.css">
    <link rel="stylesheet" href="/static/css/modal.css">
</head>
<body>

<nav class="navbar sticky-top navbar-expand-lg navbar-dark bg-dark">
</nav>

<div class="container">
    <div id="index">
    <!-- System -->
    <div name="system" class="card card-main system">
        <div class="card-header">
            <div class="">
                <a id="system-col" href="#" data-toggle="collapse"
                   data-target="#collapseSys" aria-expanded="true" aria-controls="collapseSys">{{.Hyper.Name}}</a>
                <a class="btn-spot float-right" id="system-ref" href="#system"></a>
            </div>
        </div>
        <div id="collapseSys" class="collapse" aria-labelledby="headingOne" data-parent="#index">
        <div id="overview" class="card-body">
        <!-- Loading -->
        </div>
        </div>
    </div>

    <!-- Tasks -->
    <div class="card-no-border">
        <tasks></tasks>
    </div>

    <!-- Instances -->
    <div id="instances" class="card instances">
        <div class="card-header">
            <button class="btn btn-link btn-block text-left btn-sm"
                    type="button" data-toggle="collapse"
                    data-target="#collapseIns" aria-expanded="true" aria-controls="collapseIns">
                Guest Instances
            </button>
        </div>
        <div id="collapseIns" class="collapse" aria-labelledby="headingOne" data-parent="#index">
        <div class="card-body">
            <!-- Instances buttons -->
            <div class="card-header-cnt">
                <button id="create" type="button" class="btn btn-outline-dark btn-sm"
                        data-toggle="modal" data-target="#instanceCreateModal">
                    Create new instance
                </button>
                <button id="console" type="button" class="btn btn-outline-dark btn-sm">Console</button>
                <button id="start" type="button" class="btn btn-outline-dark btn-sm">Power on</button>
                <button id="refresh" type="button" class="btn btn-outline-dark btn-sm" >Refresh</button>
                <button id="more" type="button" class="btn btn-outline-dark btn-sm dropdown-toggle"
                        data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    Actions
                </button>
                <div name="btn-more" class="dropdown-menu">
                    <a id="more-start" class="dropdown-item" href="#">Power on</a>
                    <a id="more-shutdown" class="dropdown-item" href="#">Power off</a>
                    <div class="dropdown-divider"></div>
                    <a id="more-reset" class="dropdown-item" href="#">Reset</a>
                    <div class="dropdown-divider"></div>
                    <a id="more-suspend" class="dropdown-item" href="#">Suspend</a>
                    <a id="more-resume" class="dropdown-item" href="#">Resume</a>
                    <div class="dropdown-divider"></div>
                    <a id="more-destroy" class="dropdown-item" href="#">Destroy</a>
                    <div class="dropdown-divider"></div>
                    <a id="more-remove" class="dropdown-item" href="#">Remove</a>
                </div>
            </div>

            <!-- Instances display -->
            <div class="">
                <table class="table table-striped">
                    <thead>
                    <tr>
                        <th>
                            <input id="on-all" type="checkbox" aria-label="select all instances">
                        </th>
                        <th>ID</th>
                        <th>UUID</th>
                        <th>CPU Time</th>
                        <th>Name</th>
                        <th>CPU</th>
                        <th>Memory</th>
                        <th>State</th>
                    </tr>
                    </thead>
                    <tbody id="display-body">
                    <!-- Loading... -->
                    </tbody>
                </table>
            </div>
        </div>
        </div>
    </div>
    <div id="process" class="card-no-border"></div>
    <!-- DataStore -->
    <div id="datastores" class="card card-main">
        <div class="card-header">
            <button class="btn btn-link btn-block text-left btn-sm"
                    type="button" data-toggle="collapse"
                    data-target="#collapseStore" aria-expanded="true" aria-controls="collapseStore">
                Local Datastores
            </button>
        </div>
        <div id="collapseStore" class="collapse" aria-labelledby="headingOne" data-parent="#index">
            <div class="card-body">
                <!-- DataStore buttons -->
                <div class="card-header-cnt">
                    <div id="create-btns" class="btn-group btn-group-sm" role="group">
                        <button id="create" type="button" class="btn btn-outline-dark btn-sm"
                                data-toggle="modal" data-target="#dirCreateModal">
                            New a datastore
                        </button>
                        <button id="creates" type="button"
                                class="btn btn-outline-dark dropdown-toggle dropdown-toggle-split"
                                data-toggle="dropdown" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div id="create-more" class="dropdown-menu" aria-labelledby="creates">
                            <a id="create-nfs" class="dropdown-item" data-toggle="modal" data-target="#nfsCreateModal">
                                New NFS datastore
                            </a>
                            <div class="dropdown-divider"></div>
                            <a id="create-iscsi" class="dropdown-item" data-toggle="modal" data-target="#iscsiCreateModal">
                                New iSCSI datastore
                            </a>
                        </div>
                    </div>
                    <button id="upload" type="button" class="btn btn-outline-dark btn-sm"
                            data-toggle="modal" data-target="#fileUploadModal">
                        Upload
                    </button>
                    <button id="edit" type="button" class="btn btn-outline-dark btn-sm">Edit</button>
                    <button id="delete" type="button" class="btn btn-outline-dark btn-sm">Delete</button>
                    <button id="refresh" type="button" class="btn btn-outline-dark btn-sm" >Refresh</button>
                </div>

                <!-- DataStore display -->
                <div class="l-content-body">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th><input id="on-all" type="checkbox"></th>
                            <th>ID</th>
                            <th>UUID</th>
                            <th>Name</th>
                            <th>Source</th>
                            <th>Capacity</th>
                            <th>Available</th>
                            <th>State</th>
                        </tr>
                        </thead>
                        <tbody id="display-table">
                        <!-- Loading... -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Network -->
    <div id="networks" class="card card-main">
        <div class="card-header">
            <button class="btn btn-link btn-block text-left btn-sm"
                    type="button" data-toggle="collapse"
                    data-target="#collapseNet" aria-expanded="true" aria-controls="collapseNet">
                Virtual Networks
            </button>
        </div>
        <div id="collapseNet" class="collapse" aria-labelledby="headingOne" data-parent="#index">
            <div class="card-body">
                <!-- Network buttons -->
                <div class="card-header-cnt">
                    <div id="create-btns" class="btn-group btn-group-sm" role="group">
                        <button id="create" type="button" class="btn btn-outline-dark btn-sm"
                                data-toggle="modal" data-target="#natCreateModal">
                            Create network
                        </button>
                        <button id="creates" type="button"
                                class="btn btn-outline-dark dropdown-toggle dropdown-toggle-split"
                                data-toggle="dropdown" aria-expanded="false">
                            <span class="sr-only">Toggle Dropdown</span>
                        </button>
                        <div id="create-more" class="dropdown-menu" aria-labelledby="creates">
                            <a id="create-routed" class="dropdown-item" data-toggle="modal" data-target="#routedCreateModal">
                                Routed network
                            </a>
                            <div class="dropdown-divider"></div>
                            <a id="create-isolated" class="dropdown-item" data-toggle="modal" data-target="#isolatedCreateModal">
                                Isolated network
                            </a>
                            <div class="dropdown-divider"></div>
                            <a id="create-bridge" class="dropdown-item" data-toggle="modal" data-target="#bridgeCreateModal">
                                Host bridge
                            </a>
                        </div>
                    </div>
                    <button id="edit" type="button" class="btn btn-outline-dark btn-sm">Edit</button>
                    <button id="delete" type="button" class="btn btn-outline-dark btn-sm">Delete</button>
                    <button id="refresh" type="button" class="btn btn-outline-dark btn-sm" >Refresh</button>
                </div>

                <!-- Network display -->
                <div class="l-content-body">
                    <table class="table table-striped">
                        <thead>
                        <tr>
                            <th><input id="on-all" type="checkbox"></th>
                            <th>ID</th>
                            <th>UUID</th>
                            <th>Name</th>
                            <th>Address</th>
                            <th>Mode</th>
                            <th>State</th>
                        </tr>
                        </thead>
                        <tbody id="display-table">
                        <!-- Loading -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    </div>
</div>

<!-- Create instance modal -->
<div id="instanceCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>

<!-- Create datastore modal -->
<div id="dirCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
<!-- Upload file modal -->
<div id="fileUploadModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
<div id="nfsCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
<div id="iscsiCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>

<!-- Create network modal -->
<div id="natCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
<div id="bridgeCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
<div id="routedCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>
<div id="isolatedCreateModal" class="modal fade" tabindex="-1" role="dialog" aria-hidden="true"></div>

<!-- JQuery Javascript -->
<script src="/static/asset/jquery-1.12.4.js"></script>
<script src="/static/asset/ui/1.12.1/jquery-ui.js"></script>

<script src="/static/asset/popper.js/1.12.9/umd/popper.js"></script>
<!-- Bootstrap Javascript -->
<script src="/static/asset/bootstrap/4.0.0/js/bootstrap.js"></script>
<!-- ART Template Javascript -->
<script src="/static/asset/template-web.js"></script>

<script type="module">
    import {Utils} from "/static/js/com/utils.js";
    import {Filters} from "/static/js/filter.js";
    import {Collapse} from "/static/js/widget/collapse.js";
    import {Overview} from "/static/js/widget/index/overview.js";
    import {Instances} from '/static/js/instances.js';
    import {Network} from "/static/js/network.js";
    import {DataStore} from "/static/js/datastore.js";
    import {InstanceCreate} from '/static/js/widget/instance/create.js';
    import {NATCreate} from "/static/js/widget/network/create.js";
    import {BridgeCreate} from "/static/js/widget/network/bridge/create.js";
    import {RoutedCreate} from "/static/js/widget/network/routed/create.js";
    import {IsolatedCreate} from "/static/js/widget/network/isolated/create.js";
    import {DirCreate} from "/static/js/widget/datastore/create.js";
    import {NFSCreate} from "/static/js/widget/datastore/nfs/create.js";
    import {iSCSICreate} from "/static/js/widget/datastore/iscsi/create.js";
    import {Navigation} from "/static/js/widget/navigation.js";


    $(document).ready(function() {
        new Navigation({
            id: "nav",
            home: "."
        });
        new Filters();
        new Collapse({
            pages: [
                {id: '#collapseSys', name: 'system'},
                {id: '#collapseIns', name: 'instances'},
                {id: '#collapseStore', name: 'datastore'},
                {id: '#collapseNet', name: 'network'}
            ],
            default: "instances",
        });

        // loading overview.
        let view = new Overview({
            id: '#overview',
        });
        view.refresh();
        // register click on overview.
        $('#system-ref').on('click', () => {
            view.refresh();
            $('#collapseSys').collapse('show');
        });

        let ins = new Instances({
            id: '#instances',
        });
        new InstanceCreate({id: '#instanceCreateModal'})
            .onsubmit((e) => {
                ins.create(Utils.toJSON(e.form));
            });

        // loading network.
        let net = new Network({id: '#networks'});
        new NATCreate({id: '#natCreateModal'})
            .onsubmit((e) => {
                net.create(Utils.toJSON(e.form));
            });
        new BridgeCreate({id: '#bridgeCreateModal'})
            .onsubmit((e) => {
                net.create(Utils.toJSON(e.form));
            });
        new RoutedCreate({id: '#routedCreateModal'})
            .onsubmit((e) => {
                net.create(Utils.toJSON(e.form));
            });
        new IsolatedCreate({id: '#isolatedCreateModal'})
            .onsubmit((e) => {
                net.create(Utils.toJSON(e.form));
            });

        // loading datastore.
        let store = new DataStore({
            id: '#datastores',
            upload: '#fileUploadModal',
        });
        new DirCreate({id: '#dirCreateModal'})
            .onsubmit((e) => {
                store.create(Utils.toJSON(e.form));
            });
        new NFSCreate({id: '#nfsCreateModal'})
            .onsubmit((e) => {
                store.create(Utils.toJSON(e.form));
            });
        new iSCSICreate({id: '#iscsiCreateModal'})
            .onsubmit((e) => {
                store.create(Utils.toJSON(e.form));
            });
    });
</script>
</body>
</html>